<template>
    <div>
        <div class="pmrequest-title pmrequest-row">
            Запросы
        </div>
        <div class="pmrequest-row">
            <el-select placeholder="Запрос по" class="pmrequest-select" v-model="type" @change="onTypeChange">
                <el-option v-for="option in options" :key="option.value" :value="option.value" :label="option.label">
                </el-option>
            </el-select>
        </div>
        <div v-if="type == 1">
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Поиск по:
                </div>

            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Подразделению
                </div>
                <el-button @click="addStructure" size="mini">Добавить подразделение</el-button>
                <el-button v-if="structureTrees.length > 0" @click="clear(structureTrees)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>

            <div class="pmrequest-structure-element" v-for="(sub, key, index) in structureTrees">
                {{key + 1}} - {{sub.tree}}
                <el-button size="mini" @click="removeStructure(sub.id)">Удалить</el-button>
            </div>

            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Меткам групп подразделений
                </div>
                <el-select v-model="structuretype" class="pmrequest-select" placeholder="Метки группы подразделений" multiple filterable no-match-text="Не найдено">
                    <el-option v-for="stype in structuretypes" :title="stype.name"
                               :key="stype.id" :label="stype.name" :value="stype.id">
                    </el-option>
                </el-select>
                <el-button v-if="structuretype.length > 0" @click="clear(structuretype)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Должностям
                </div>
                <el-select v-model="positiontype" class="pmrequest-select" placeholder="Наименования должностей" multiple filterable no-match-text="Не найдено">
                    <el-option v-for="ptype in positiontypes" :title="ptype.name"
                               :key="ptype.id" :label="shortifyTitle(ptype.name)" :value="ptype.id">
                    </el-option>
                </el-select>
                <el-button v-if="positiontype.length > 0" @click="clear(positiontype)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Предельным званиям
                </div>
                <el-select v-model="rank" class="pmrequest-select" placeholder="Предельные звания" multiple filterable no-match-text="Не найдено" :disabled="ranksexpanded">
                    <el-option v-for="r in ranks" :title="r.name"
                               :key="r.id" :label="r.name" :value="r.id">
                    </el-option>
                </el-select>
                <el-button v-if="rank.length > 0" @click="clear(rank)" icon="el-icon-circle-close-outline" size="mini"></el-button>
                <el-checkbox class="pmrequest-marginleft" v-model="ranksexpanded">

                </el-checkbox>
                <div class="pmrequest-label">
                    Расширенный вывод по званиям
                </div>
            </div>
            <div class="pmrequest-row pmrequest-label">
                <el-checkbox v-model="civilonly">Только гражданские</el-checkbox>
            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Категориям
                </div>
                <el-select v-model="positioncategory" class="pmrequest-select" placeholder="Категории" multiple filterable no-match-text="Не найдено">
                    <el-option v-for="pcategory in positioncategories" :title="pcategory.name"
                               :key="pcategory.id" :label="pcategory.name" :value="pcategory.id">
                    </el-option>
                </el-select>
                <!--                <el-button v-if="positioncategory != null" @click="clear(positioncategory)" icon="el-icon-circle-close-outline" size="mini"></el-button>-->
            </div>
            <div class="pmrequest-row pmrequest-label">
                <el-checkbox v-model="notopchs">Не относятся к ОПЧС</el-checkbox>
            </div>
            <div class="pmrequest-row pmrequest-label">
                Класс гос. служащего
            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    От максимального класса гос. служащего
                </div>
                <el-input v-model="civilclasshigh" class="pmrequest-input-num" type="number" clearable></el-input>
                <div class="pmrequest-label">
                    До минимального
                </div>
                <el-input v-model="civilclasslow" class="pmrequest-input-num" type="number" clearable></el-input>

            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Источникам финансирования
                </div>
                <el-select v-model="sof" class="pmrequest-select" placeholder="Источники финансирования" multiple filterable no-match-text="Не найдено">
                    <el-option v-for="s in sofs" :title="s.name"
                               :key="s.id" :label="s.name" :value="s.id">
                    </el-option>
                </el-select>
                <el-button v-if="sof.length > 0" @click="clear(sof)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Меткам родов деятельности
                </div>
                <el-select v-model="mrd" class="pmrequest-select" placeholder="Метки рода деятельности" multiple filterable no-match-text="Не найдено">
                    <el-option v-for="m in mrds" :title="m.name"
                               :key="m.id" :label="m.name" :value="m.id">
                    </el-option>
                </el-select>
                <el-button v-if="mrd.length > 0" @click="clear(mrd)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>
            <div class="pmrequest-block">
                <div class="pmrequest-row">
                    <el-checkbox v-model="replacedbycivil" @change="replacedbycivilnot = false">Только те, которые могут замещаться гражданским</el-checkbox>

                </div>
                <div class="pmrequest-row">
                    <el-checkbox v-model="replacedbycivilnot" @change="replacedbycivil = false">Только те, которые не могут замещаться гражданским</el-checkbox>
                </div>
            </div>
            <div class="pmrequest-block">
                <div class="pmrequest-row">
                    <el-checkbox v-model="decertificate">Имеется дата разаттестации</el-checkbox>
                </div>
                <div class="pmrequest-row">
                    <el-checkbox v-model="decertificateexpired">Должность должна быть разаттестована к текущей дате</el-checkbox>
                </div>
            </div>

            <div class="pmrequest-block">
                <div class="pmrequest-row">
                    <el-checkbox v-model="replacedbycivildateavailable">Имеется срок окончания замещения</el-checkbox>
                </div>
                <div class="pmrequest-row">
                    <el-checkbox v-model="replacedbycivildateexpired">Срок окончания замещения истек</el-checkbox>
                </div>
            </div>

            <div class="pmrequest-block">
                <div class="pmrequest-row">
                    <el-checkbox v-model="signed">Приказ подписан</el-checkbox>
                </div>
                <div class="pmrequest-row">
                    <el-checkbox v-model="notsigned">Приказ не подписан</el-checkbox>
                </div>
                <!--<div class="pmrequest-row">
                <el-checkbox v-model="willbesigned">Должность будет введена, и приказ подписан</el-checkbox>
            </div>
            <div class="pmrequest-row">
                <el-checkbox v-model="willbenotsigned">Должность будет введена, но приказ не подписан</el-checkbox>
            </div>-->
            </div>
            <div class="pmrequest-row">

            </div>
            <div class="pmrequest-row">
                Параметры вывода
            </div>
            <div class="pmrequest-row">
                <el-checkbox v-model="displaytreeseparately">Подразделения в отдельные стобцы</el-checkbox>
            </div>

            <div class="pmrequest-row">
                <el-button @click="request" :disabled="loading">Запрос</el-button>
                <div v-if="loading" class="pmrequest-spinner fingerprint-spinner">
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                </div>
            </div>
        </div>








        <div v-if="type == 2">
            <div class="pmrequest-row">
                <el-checkbox v-model="structurecountmode">Режим предоставления сведений о штатной численности</el-checkbox>
            </div>
            <div class="pmrequest-row">
                <el-checkbox v-model="structurecountallinclusive" :disabled="structureselfcount">Подсчитывать все входящие подразделения, вне зависимости от типа</el-checkbox>
            </div>

            <div v-if="!structurecountmode">
                <b>Параметры для основного режима</b>
                <div>
                    <el-checkbox v-model="structuresub">Включать подчиненные подразделения подразделений, прошедших фильтрацию</el-checkbox>
                </div>
                <div>
                    Уровень вложенности для пункта выше. 0, если неограниченный
                    <el-input v-model="structuresublevel" type="number" :disabled="!structuresub"></el-input>
                </div>
                <div>
                    <el-checkbox v-model="structureselfcount" :disabled="structurecountallinclusive">Не включать численность подчиненных подразделений</el-checkbox>
                </div>
            </div>
            <br />
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Поиск по:
                </div>

            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Подразделению
                </div>
                <el-button @click="addStructure" size="mini">Добавить подразделение</el-button>
            </div>

            <div class="pmrequest-structure-element" v-for="(sub, key, index) in structureTrees">
                {{key + 1}} - {{sub.tree}}
                <el-button size="mini" @click="removeStructure(sub.id)">Удалить</el-button>
            </div>

            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Метки типов подразделений
                </div>
                <el-select v-model="structuretype" class="pmrequest-select" placeholder="Метки типов подразделений" multiple filterable no-match-text="Не найдено">
                    <el-option v-for="stype in structuretypes" :title="stype.name"
                               :key="stype.id" :label="stype.name" :value="stype.id">
                    </el-option>
                </el-select>
                <el-button v-if="structuretype.length > 0" @click="clear(structuretype)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Разряду подразделения
                </div>
                <!--<el-input v-model="structurerank" type="number" clearable></el-input>-->
                <el-select v-model="structurerank" class="pmrequest-select" placeholder="Разряды подразделений" multiple filterable no-match-text="Не найдено">
                    <el-option v-for="i in 4"
                               :key="i-1" :label="i-1" :value="i-1">
                    </el-option>
                </el-select>
                <el-button v-if="structurerank.length > 0" @click="clear(structurerank)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Областям
                </div>
                <el-select v-model="structureregion" class="pmrequest-select" placeholder="Области" multiple filterable no-match-text="Не найдено">
                    <el-option v-for="sregion in structureregions" :title="sregion.name"
                               :key="sregion.id" :label="sregion.name" :value="sregion.id">
                    </el-option>
                </el-select>
                <el-button v-if="structureregion.length > 0" @click="clear(structureregion)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Населенный пункт
                </div>
                <el-input v-model="structurecity" clearable></el-input>
            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Улица
                </div>
                <el-input v-model="structurestreet" clearable></el-input>
            </div>
            <div class="pmrequest-row">

            </div>
            <div class="pmrequest-row">
                Параметры вывода
            </div>
            <div class="pmrequest-row">
                <el-checkbox v-model="displaytreeseparately" :disabled="structurecountmode">Подразделения в отдельные стобцы</el-checkbox>
            </div>


            <div class="pmrequest-row">
                <el-button @click="request" :disabled="loading">Запрос</el-button>
                <div v-if="loading" class="pmrequest-spinner fingerprint-spinner">
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>

                </div>
            </div>

        </div>

        <div v-if="type == 3">
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Поиск по:
                </div>

            </div>
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Подразделению
                </div>
                <el-button @click="addStructure" size="mini">Добавить подразделение</el-button>
            </div>

            <div class="pmrequest-structure-element" v-for="(sub, key, index) in structureTrees">
                {{key + 1}} - {{sub.tree}}
                <el-button size="mini" @click="removeStructure(sub.id)">Удалить</el-button>
            </div>

            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Метки типов подразделений
                </div>
                <el-select v-model="structuretype" class="pmrequest-select" placeholder="Метки типов подразделений" multiple filterable no-match-text="Не найдено">
                    <el-option v-for="stype in structuretypes" :title="stype.name"
                               :key="stype.id" :label="stype.name" :value="stype.id">
                    </el-option>
                </el-select>
                <el-button v-if="structuretype.length > 0" @click="clear(structuretype)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>
            <!--<div class="pmrequest-row">
            <div class="pmrequest-label">
                Разряду подразделения
            </div>
            <el-select v-model="structurerank" class="pmrequest-select" placeholder="Разряды подразделений" multiple filterable no-match-text="Не найдено">
                <el-option v-for="i in 4"
                           :key="i-1" :label="i-1" :value="i-1">
                </el-option>
            </el-select>
        </div>
        <div class="pmrequest-row">
            <div class="pmrequest-label">
                Областям
            </div>
            <el-select v-model="structureregion" class="pmrequest-select" placeholder="Области" multiple filterable no-match-text="Не найдено">
                <el-option v-for="sregion in structureregions" :title="sregion.name"
                           :key="sregion.id" :label="sregion.name" :value="sregion.id">
                </el-option>
            </el-select>
        </div>
        <div class="pmrequest-row">
            <div class="pmrequest-label">
                Населенный пункт
            </div>
            <el-input v-model="structurecity" clearable></el-input>
        </div>
        <div class="pmrequest-row">
            <div class="pmrequest-label">
                Улица
            </div>
            <el-input v-model="structurestreet" clearable></el-input>
        </div>
        <div class="pmrequest-row">

        </div>
        <div class="pmrequest-row">
            Параметры вывода
        </div>
        <div class="pmrequest-row">
            <el-checkbox v-model="displaytreeseparately" :disabled="structurecountmode">Подразделения в отдельные стобцы</el-checkbox>
        </div>-->



            <div class="pmrequest-row">
                <el-button @click="request" :disabled="loading">Запрос</el-button>
                <div v-if="loading" class="pmrequest-spinner fingerprint-spinner">
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>

                </div>
            </div>

        </div>


        <div v-if="type == 4">
            <div class="pmrequest-row">
                <div class="pmrequest-label">
                    Подразделение
                </div>
                <el-button @click="addStructure" size="mini">Добавить подразделение</el-button>
                <el-button v-if="structureTrees.length > 0" @click="clear(structureTrees)" icon="el-icon-circle-close-outline" size="mini"></el-button>
            </div>
            <div class="pmrequest-structure-element" v-for="(sub, key, index) in structureTrees">
                {{key + 1}} - {{sub.tree}}
                <el-button size="mini" @click="removeStructure(sub.id)">Удалить</el-button>
            </div>

            <div v-if="structureTrees.length > 0">
                <el-collapse v-model="activeName" accordion class="eld-eld-side-element">
                    <el-collapse-item title="Образование" name="1" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #eeece0;">
                            <el-select v-if="education_datas.all_specializations.length > 0" v-model="education_request.specializationList"
                                       multiple
                                       filterable
                                       placeholder="Выберите специализацию"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in education_datas.all_specializations"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                            <el-select v-if="education_datas.all_cvalifications.length > 0" v-model="education_request.cvalificationList"
                                       multiple
                                       filterable
                                       placeholder="Выберите квалификацию"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in education_datas.all_cvalifications"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                        </div>
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0; display: flex; justify-content: space-between;">
                            Уровень образования:
                            <el-select v-if="education_datas.all_levels.length > 0" v-model="education_request.educationLevel"
                                       multiple
                                       filterable
                                       placeholder="Выберите специализацию"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in education_datas.all_levels"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                        </div>
                        <el-button @click="education_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="education_resualt.length > 0">
                            <el-button @click="educationDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="education_resualt" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="education.speciality" label="Специальность" sortable></el-table-column>
                            <el-table-column prop="education.qualification" label="Квалификация" sortable></el-table-column>
                            <el-table-column prop="education.end" label="Дата окончания" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="education_resualt.length > 0">
                            <el-button @click="educationDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <!--<div>Implementation resualt.</div>-->
                    </el-collapse-item>
                    <el-collapse-item title="Звание" name="2" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <span class="demo-input-label">Срок истечения выслуги в звании, до:</span>
                            <el-date-picker placeholder="Выберите дату"
                                      v-model="rank_request.last_rank_date"
                                      type="date"
                                      format="dd.MM.yyyy">
                            </el-date-picker>
                            <el-switch v-model="rank_request.corelate_rank"
                                       active-text="Не соответсвие должности"
                                       inactive-text="">
                            </el-switch>
                        </div>
                        <el-button @click="rank_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="rank_resualt.length > 0">
                            <el-button @click="rankDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="rank_resualt" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="rank.name" label="Звание" sortable></el-table-column>
                            <el-table-column prop="rank.date_end" label="Дата окончания" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="rank_resualt.length > 0">
                            <el-button @click="rankDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <!--<div>Implementation resualt.</div>-->
                    </el-collapse-item>
                    <el-collapse-item title="Контракт" name="3" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <span class="demo-input-label">Срок истечения контракта, до:</span>
                            <el-date-picker placeholder="Выберите дату"
                                      v-model="contract_request.last_contract_date"
                                      type="date"
                                      format="dd.MM.yyyy">
                            </el-date-picker>
                        </div>
                        <el-button @click="contract_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="contruct_resualt.length > 0">
                            <el-button @click="contructDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="contruct_resualt" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="contract.orderid" label="Номер приказа" sortable></el-table-column>
                            <el-table-column prop="contract.dateend" label="Дата окончания" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="contruct_resualt.length > 0">
                            <el-button @click="contructDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <!--<div>Implementation resualt.</div>-->
                    </el-collapse-item>
                    <el-collapse-item title="Отпуск" name="4" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <span class="demo-input-label">Количество не использованных дней:</span>
                            <el-input-number :min="0" placeholder="Выберите минимальное количество дней отпуска"
                                             v-model="vacation_request.minimal_days">
                            </el-input-number>
                            <el-switch v-model="vacation_request.old_year_days"
                                       active-text="есть дни отпуска с прошлого периода"
                                       inactive-text="">
                            </el-switch>
                        </div>
                        <el-button @click="vacation_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="vacation_resualt.length > 0">
                            <el-button @click="vacationDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="vacation_resualt" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="education.main" label="Оставшихся дней" sortable></el-table-column>
                            <el-table-column prop="education.durationmax" label="Максимальное количество дней" sortable></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="vacation_resualt.length > 0">
                            <el-button @click="vacationDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <!--<div>Implementation resualt.</div>-->
                    </el-collapse-item>
                    <el-collapse-item title="Награды" name="5" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #eeece0;">
                            <el-select v-if="award_datas.award_type.length > 0" v-model="award_request.awards_type"
                                       multiple
                                       filterable
                                       placeholder="Выберите тип награды"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in award_datas.award_type"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                            <el-select v-if="award_datas.awards.length > 0" v-model="award_request.awards"
                                       multiple
                                       filterable
                                       placeholder="Выберите название награды"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in award_datas.awards"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                            <el-switch v-model="award_request.keep"
                                       active-text="сотрудник имеет награды данных категорий"
                                       inactive-text="сотрудник не имеет награды данных категорий">
                            </el-switch>
                        </div>
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <span class="demo-input-label">Минимальное количество наград:</span>
                            <el-input-number :min="0" placeholder="Выберите минимальное количество наград"
                                             v-model="award_request.min_awards_number">
                            </el-input-number>
                            <el-switch v-model="award_request.others"
                                       active-text="награды других органов"
                                       inactive-text="">
                            </el-switch>
                        </div>
                        <el-button @click="award_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="award_response.length > 0">
                            <el-button @click="awardDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="award_response" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="award_type.name" label="Тип награды" sortable></el-table-column>
                            <el-table-column prop="award.name" label="название награды" sortable></el-table-column>
                            <el-table-column prop="award_new.orderwho" label="Орган" sortable></el-table-column>
                            <el-table-column prop="award_new.rewarddate" label="Дата присваения" sortable :formatter="formatter_el_table_collumn_date"></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="award_response.length > 0">
                            <el-button @click="awardDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <!--<div>Implementation resualt.</div>-->
                    </el-collapse-item>
                    <el-collapse-item title="Удостоверение" name="6" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <span class="demo-input-label">Дата окончания удостоверения:</span>
                            <el-date-picker placeholder="Выберите дату"
                                      v-model="certificate_request.data_end"
                                      type="date"
                                            format="dd.MM.yyyy">
                            </el-date-picker>
                            <el-switch v-model="certificate_request.position_conformity"
                                       active-text="Удостоверение не соответствует должности"
                                       inactive-text="">
                            </el-switch>
                        </div>
                        <el-button @click="certificate_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="certificate_response.length > 0">
                            <el-button @click="certificateDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="certificate_response" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="certificate.numud" label="номер удостоверения" sortable></el-table-column>
                            <el-table-column prop="certificate.expirationdate" label="Дата окончания" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="certificate_response.length > 0">
                            <el-button @click="certificateDownload" :disabled="loading">Скачать</el-button>
                        </div>
                    </el-collapse-item>
                    <el-collapse-item title="Аттестация" name="7" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <span class="demo-input-label">Дата последеней аттестации:</span>
                            <el-date-picker placeholder="С:"
                                            v-model="attestation_request.lastdatestart"
                                            type="date"
                                            format="dd.MM.yyyy">
                            </el-date-picker>
                            <el-date-picker placeholder="По:"
                                            v-model="attestation_request.lastdateend"
                                            type="date"
                                            format="dd.MM.yyyy">
                            </el-date-picker>
                            <el-switch v-model="attestation_request.overdue"
                                       active-text="Аттестация просрочена"
                                       inactive-text="">
                            </el-switch>
                        </div>
                        <el-button @click="attestation_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="attestation_response.length > 0">
                            <el-button @click="attestationDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="attestation_response" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="attestation.result" label="Результат"></el-table-column>
                            <el-table-column prop="attestation.date" label="Дата проведения" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                            <el-table-column prop="attestation.validity" label="Дата окончания" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="attestation_response.length > 0">
                            <el-button @click="attestationDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <!--<div>Implementation resualt.</div>-->
                    </el-collapse-item>
                    <el-collapse-item title="Иностранные языки" name="8" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #eeece0;">
                            <el-select v-if="language_datas.language.length > 0" v-model="language_request.languages"
                                       multiple
                                       filterable
                                       placeholder="Выберите иностранные языки"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in language_datas.language"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                            <el-select v-if="language_datas.language_skill.length > 0" v-model="language_request.skills"
                                       multiple
                                       filterable
                                       placeholder="Выберите уровень владения"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in language_datas.language_skill"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                        </div>
                        <el-button @click="language_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="language_response.length > 0">
                            <el-button @click="languageDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="language_response" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="languages" label="язык" sortable></el-table-column>
                            <el-table-column prop="skill" label="уровень владения" sortable></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="language_response.length > 0">
                            <el-button @click="languageDownload" :disabled="loading">Скачать</el-button>
                        </div>
                    </el-collapse-item>
                    <!--<el-collapse-item title="Учёные степени" name="9" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <span class="demo-input-label">Количество оставшихся дней:</span>
                            <el-input-number placeholder="Выберите минимальное количество дней отпуска"
                                             v-model="">
                            </el-input-number>
                            <el-switch v-model=""
                                       active-text="есть дни отпуска с прошлого периода"
                                       inactive-text="">
                            </el-switch>
                        </div>
                        <el-button @click="" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="vacation_resualt.length > 0">
                            <el-button @click="vacationDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="vacation_resualt" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person.name" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="vacation.cancel" label="оставшихся дней" sortable></el-table-column>
                            <el-table-column prop="vacation.date_end" label="Дата окончания" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="vacation_resualt.length > 0">
                            <el-button @click="vacationDownload" :disabled="loading">Скачать</el-button>
                        </div>-->
                        <!--<div>Implementation resualt.</div>-->
                    <!--</el-collapse-item>-->
                    <el-collapse-item title="Выборные органы" name="10" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #eeece0;">
                            <el-select v-if="election_datas.location.length > 0" v-model="election_request.locations"
                                       multiple
                                       filterable
                                       placeholder="Выберите территорию"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in election_datas.location"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                            <el-select v-if="election_datas.rank.length > 0" v-model="election_request.ranks"
                                       multiple
                                       filterable
                                       placeholder="Выберите должность"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in election_datas.rank"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                            <el-select v-if="election_datas.place.length > 0" v-model="election_request.places"
                                       multiple
                                       filterable
                                       placeholder="Выберите орган"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in election_datas.place"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                        </div>
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <div>
                                <span class="demo-input-label">Выберите период начала участия:</span>
                                <el-date-picker v-model="election_request.startperiod"
                                                type="daterange"
                                                start-placeholder="С"
                                                end-placeholder="По"
                                                format="dd.MM.yyyy">
                                </el-date-picker>
                            </div>
                            <div>
                                <span class="demo-input-label">Выберите период выбытия:</span>
                                <el-date-picker v-model="election_request.endperiod"
                                                type="daterange"
                                                start-placeholder="С"
                                                end-placeholder="По"
                                                format="dd.MM.yyyy">
                                </el-date-picker>
                            </div>
                        </div>
                        <el-button @click="election_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="election_response.length > 0">
                            <el-button @click="electionDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="election_response" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="election.location" label="Территория" sortable></el-table-column>
                            <el-table-column prop="election.electionwho" label="Должность" sortable></el-table-column>
                            <el-table-column prop="election.electionwhat" label="Орган" sortable></el-table-column>
                            <el-table-column prop="election.electiondate" label="Вступление" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                            <el-table-column prop="election.electiondateend" label="Выбытие" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="election_response.length > 0">
                            <el-button @click="electionDownload" :disabled="loading">Скачать</el-button>
                        </div>
                    </el-collapse-item>
                    <el-collapse-item title="Служебные командировки" name="11" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #eeece0;">
                            <el-select v-if="trips_datas.countres.length > 0" v-model="trip_request.country"
                                       multiple
                                       filterable
                                       placeholder="Выберите территорию"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in trips_datas.countres"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                            <el-select v-if="trips_datas.reasons.length > 0" v-model="trip_request.reason"
                                       multiple
                                       filterable
                                       placeholder="Выберите должность"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in trips_datas.reasons"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                        </div>
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <div>
                                <span class="demo-input-label">Выберите период загранпоездки:</span>
                                <el-date-picker v-model="trip_request.period"
                                                type="daterange"
                                                start-placeholder="С"
                                                end-placeholder="По"
                                                format="dd.MM.yyyy">
                                </el-date-picker>
                            </div>
                        </div>
                        <el-button @click="trip_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="trip_response.length > 0">
                            <el-button @click="tripDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="trip_response" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="country" label="Страна" sortable></el-table-column>
                            <el-table-column prop="trip.tripdate" label="Дата" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                            <el-table-column prop="trip.days" label="Дней" sortable></el-table-column>
                            <el-table-column prop="trip.reason" label="Причина" sortable></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="trip_response.length > 0">
                            <el-button @click="tripDownload" :disabled="loading">Скачать</el-button>
                        </div>
                    </el-collapse-item>
                    <el-collapse-item title="Взыскания" name="12" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #eeece0;">
                            <el-select v-if="punishment_datas.type.length > 0" v-model="punishment_request.types"
                                       multiple
                                       filterable
                                       placeholder="Выберите тип"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in punishment_datas.type"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                            <el-select v-if="punishment_datas.who.length > 0" v-model="punishment_request.who"
                                       multiple
                                       filterable
                                       placeholder="Выберите кто накладывал"
                                       class="eld-eld-body-select-long-request"
                                       no-match-text="Не найдено">
                                <el-option v-for="item in punishment_datas.who"
                                           :key="item"
                                           :label="item"
                                           :value="item">
                                </el-option>
                            </el-select>
                        </div>
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <div>
                                <span class="demo-input-label">Выберите период наложения:</span>
                                <el-date-picker v-model="punishment_request.period"
                                                type="daterange"
                                                start-placeholder="С"
                                                end-placeholder="По"
                                                format="dd.MM.yyyy">
                                </el-date-picker>
                            </div>
                        </div>
                        <el-button @click="punishment_request_button" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="punishment_response.length > 0">
                            <el-button @click="punishmentDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="punishment_response" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="penalty_string" label="Тип" sortable></el-table-column>
                            <el-table-column prop="penalty.violation" label="Нарушение" sortable></el-table-column>
                            <el-table-column prop="penalty.orderwho" label="Наложил" sortable></el-table-column>
                            <el-table-column prop="penalty.orderdate" label="Дата" sortable :formatter="formatting.formatter_el_table_collumn_date"></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="punishment_response.length > 0">
                            <el-button @click="punishmentDownload" :disabled="loading">Скачать</el-button>
                        </div>
                    </el-collapse-item>
                    <!--<el-collapse-item title="Водительское удостоверение" name="13" class="eld-eld-side-element-folder">
                        <div style="margin-bottom: 4px; box-shadow: 5px 5px 3px rgba(0,0,0,0.6); padding: 10px; border-radius: 10px; background: #f6b0b0;">
                            <span class="demo-input-label">Количество оставшихся дней:</span>
                            <el-input-number placeholder="Выберите минимальное количество дней отпуска"
                                             v-model="">
                            </el-input-number>
                            <el-switch v-model=""
                                       active-text="есть дни отпуска с прошлого периода"
                                       inactive-text="">
                            </el-switch>
                        </div>
                        <el-button @click="" type="success" plain>Отправить запрос</el-button>
                        <div class="pmrequest-row" v-if="vacation_resualt.length > 0">
                            <el-button @click="vacationDownload" :disabled="loading">Скачать</el-button>
                        </div>
                        <el-table :data="vacation_resualt" empty-text="Сотрудников не найдено">
                            <el-table-column prop="person.numpersonal" label="Номер"></el-table-column>
                            <el-table-column prop="person.name" label="ФИО" sortable :formatter="formatting.formatter_el_table_fullname"></el-table-column>
                            <el-table-column prop="vacation.cancel" label="оставшихся дней" sortable></el-table-column>
                            <el-table-column prop="vacation.date_end" label="Дата окончания" sortable></el-table-column>
                        </el-table>
                        <div class="pmrequest-row" v-if="vacation_resualt.length > 0">
                            <el-button @click="vacationDownload" :disabled="loading">Скачать</el-button>
                        </div>-->
                        <!--<div>Implementation resualt.</div>-->
                    <!--</el-collapse-item>-->
                </el-collapse>
            </div>
        </div>


        <el-dialog :visible.sync="exceldialogvisible" width="60%" append-to-body>
            <div v-if="!newdisplay">
                <div class="pmrequest-row">
                    <div v-if="pmresultsingleranksdisplay">
                        <div>
                            По званиям
                        </div>
                        <div v-for="singlerank in pmresultsingleranks" class="pmrequest-singlerank">
                            <div>
                                <b>{{singlerank.rank}}</b>
                            </div>
                            <div>
                                {{singlerank.uprankready}}
                            </div>
                            <div>
                                Предельное звание — {{singlerank.defaultcount}}
                            </div>
                            <div>
                                Максимальное предельное звание — {{singlerank.maxcount}}
                            </div>
                            <div>
                                Максимально возможное количество — {{singlerank.absolutecount}}
                            </div>

                            <div>
                                Минимально возможное количество — {{singlerank.mincount}}
                            </div>

                        </div>
                        <div class="pmrequest-singlerank">
                            <div>
                                <b>Гражданские должности</b>
                            </div>
                            <div v-for="civilPart in civil">
                                {{civilPart.name}} — {{civilPart.count}}
                            </div>
                        </div>
                    </div>
                    <div v-else>
                        <table class="pmrequest-label">
                            <tr v-for="singlerank in pmresultsingleranks" class="pmrequest-table-tr ">
                                <td class="pmrequest-table-td">
                                    {{singlerank.rank}}
                                </td>
                                <td class="pmrequest-table-td">
                                    {{singlerank.defaultcount}}
                                </td>
                                <td v-for="uprankmappart in singlerank.uprankmappart" class="pmrequest-table-td">
                                    {{uprankmappart}}
                                </td>
                            </tr>
                        </table>

                        Дано:
                        <table class="pmrequest-table">
                            <tr v-for="singlerank in pmresultsingleranks" class="pmrequest-table-tr ">
                                <td class="pmrequest-table-td">
                                    {{singlerank.rank}}
                                </td>
                                <td class="pmrequest-table-td">
                                    {{singlerank.defaultcount}}
                                </td>
                                <td class="pmrequest-table-td">
                                    {{singlerank.uprankready}}
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="pmrequest-row">
                    Итого — {{count}}
                </div>
            </div>
            <!--NEW-->
            <div v-else>
                <div v-if="pmresultsingleranksdisplay">
                    <div class="pmrequest-singlerank-new" v-for="singlerank in pmresultsingleranks">
                        <div class="pmrequest-singlerank-title">
                            <div>
                                СВЕДЕНИЯ
                            </div>
                            <div>
                                о штатной численности со специальным званием "{{singlerank.rank}}"
                            </div>
                        </div>
                        <table class="pmrequest-tablenew">
                            <tr>
                                <td>
                                    Общее количество со специальным званием "{{singlerank.rank}}"
                                </td>
                                <td class="pmrequest-tablenew-td-border">
                                    <b>{{singlerank.maxcount}} ед.</b>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>из них:</b>
                                </td>
                                <td class="pmrequest-tablenew-noborder">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    имеют предельное звание "{{singlerank.rank}}"
                                </td>
                                <td class="pmrequest-tablenew-td-border">
                                    {{singlerank.defaultcount}} ед.
                                </td>
                            </tr>
                            <tr v-if="singlerank.unitedlengthmax > 0">
                                <td class="pmrequest-tablenew-td-border pmrequest-tablenew-td-back-green">
                                    повышаются до звания "{{singlerank.rank}}" со звания:
                                </td>
                                <td class="pmrequest-tablenew-td-back-red">
                                    со звания "{{singlerank.rank}}" повышаются до звания:
                                </td>
                            </tr>
                            <tr v-for="i in singlerank.unitedlengthmax">
                                <td class="pmrequest-tablenew-td-border">
                                    <table class="pmrequest-tablenew-sub">
                                        <tr v-if="getComefrominfo(singlerank, i) != null">
                                            <td class="pmrequest-tablenew-td-subfield">
                                                {{getComefrominfo(singlerank, i).name}}
                                                <template v-if="getComefrominfo(singlerank, i).up == 1">
                                                    (на 1 звание)
                                                </template>
                                                <template v-else>
                                                    (на {{getComefrominfo(singlerank, i).up}} звания)
                                                </template>
                                            </td>
                                            <td class="pmrequest-tablenew-td-back-green pmrequest-tablenew-td-subnumber">
                                                {{getComefrominfo(singlerank, i).value}} ед.
                                            </td>
                                        </tr>
                                        <tr v-else>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </table>
                                </td>
                                <td>
                                    <table class="pmrequest-tablenew-sub">
                                        <tr v-if="getUpinfo(singlerank, i) != null">
                                            <td class="pmrequest-tablenew-td-subfield">
                                                {{getUpinfo(singlerank, i).name}}
                                                <template v-if="getUpinfo(singlerank, i).up == 1">
                                                    (на 1 звание)
                                                </template>
                                                <template v-else>
                                                    (на {{getUpinfo(singlerank, i).up}} звания)
                                                </template>
                                            </td>
                                            <td class="pmrequest-tablenew-td-back-red pmrequest-tablenew-td-subnumber">
                                                {{getUpinfo(singlerank, i).value}} ед.
                                            </td>
                                        </tr>
                                        <tr v-else>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div v-else>
                    <div class="pmrequest-singlerank-title">
                        <div>
                            СВЕДЕНИЯ
                        </div>
                        <div>
                            о штатной численности подразделения с учетом повышения штатно-должностной категории
                        </div>
                    </div>
                    <table class="pmrequest-tablenew">
                        <tr>
                            <td style="width: 27%;">
                                Звание
                            </td>
                            <td class="pmrequest-tablenew-td-border-left">
                                <div class="pmrequest-tablenew-text-middle pmrequest-tablenew-td-border-bottom" style="margin-left: -6px;">
                                    Количество штатных должностей с:
                                </div>
                                <div>
                                    <table class="pmrequest-autowidth" style="margin-left: -6px;">
                                        <tr>
                                            <td v-for="i in absoluteup+1" class="pmrequest-tablenew-td-autowidth " :style="tableautowidth(absoluteup)+1">
                                                <template v-if="i == 1">
                                                    предельным званием
                                                </template>
                                                <template v-else-if="i == 2">
                                                    повышением на {{i-1}} звание
                                                </template>
                                                <template v-else>
                                                    повышением на {{i-1}} звания
                                                </template>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </td>

                        </tr>
                        <tr v-for="singlerank in pmresultsingleranks" class="pmrequest-table-tr pmrequest-tablenew-back-brown">
                            <td>
                                {{singlerank.rank}}
                            </td>
                            <td>
                                <table class="pmrequest-autowidth" style="margin-left: -6px;">
                                    <tr>
                                        <td v-for="i in absoluteup+1" class="pmrequest-tablenew-td-autowidth pmrequest-tablenew-td-heightmax" :style="tableautowidth(absoluteup)+1">
                                            <template v-if="i == 1">
                                                {{singlerank.defaultcount}}
                                            </template>
                                            <template v-else>
                                                {{singlerank.sumunited[i-2]}}
                                            </template>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr class="pmrequest-tablenew-back-silver">
                            <td>
                                Переменный состав:
                            </td>
                            <td>
                                <table class="pmrequest-autowidth" style="margin-left: -6px;">
                                    <tr>
                                        <td v-for="i in absoluteup+1" class="pmrequest-tablenew-td-subnumber " :style="tableautowidth(absoluteup+1)">
                                            {{countvar}}
                                        </td>
                                    </tr>
                                </table>
                            </td>

                        </tr>
                        <tr v-for="singlerank in pmresultsingleranks" v-if="singlerank.defaultcountvar > 0" class="pmrequest-table-tr pmrequest-tablenew-back-silver">
                            <td>
                                {{singlerank.rank}}
                            </td>
                            <td>
                                <table class="pmrequest-autowidth" style="margin-left: -6px;">
                                    <tr>
                                        <td v-for="i in absoluteup+1" class="pmrequest-tablenew-td-autowidth pmrequest-tablenew-td-heightmax" :style="tableautowidth(absoluteup)+1">
                                            {{singlerank.defaultcountvar}}
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr v-for="civilPart in civil" class="pmrequest-tablenew-back-green">
                            <td>
                                {{civilPart.name}}
                            </td>
                            <td>
                                <table class="pmrequest-autowidth" style="margin-left: -6px;">
                                    <tr>
                                        <td v-for="i in absoluteup+1" class="pmrequest-tablenew-td-subnumber " :style="tableautowidth(absoluteup+1)">
                                            <template v-if="i == 1">
                                                {{civilPart.count}}
                                            </template>
                                            <template v-else>
                                                {{civilPart.count}}
                                            </template>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                ИТОГО
                            </td>
                            <td>
                                <table class="pmrequest-autowidth" style="margin-left: -6px;">
                                    <tr>
                                        <td v-for="i in absoluteup+1" class="pmrequest-tablenew-td-subnumber " :style="tableautowidth(absoluteup+1)">
                                            {{count}}
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                    <br />
                    <table class="pmrequest-tablenew">
                        <tr>
                            <td>
                                Звание
                            </td>
                            <td class="pmrequest-tablenew-td-border-left">
                                Количество штатных ед.
                            </td>
                            <td style="width: 50%;">
                                <div class="pmrequest-tablenew-td-autowidth pmrequest-tablenew-td-border-bottom">
                                    Из них имеют возможность подняться на:
                                </div>
                                <div>
                                    <table class="pmrequest-autowidth ">
                                        <tr>
                                            <td v-for="i in absoluteup" class="pmrequest-tablenew-td-autowidth " :style="tableautowidth(absoluteup)">
                                                <!---->
                                                <template v-if="i == 1">
                                                    1 уровень
                                                </template>
                                                <template v-else>
                                                    {{i}} уровня
                                                </template>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </td>
                        </tr>
                        <tr v-for="singlerank in pmresultsingleranks" class="pmrequest-table-tr pmrequest-tablenew-back-brown">
                            <td>
                                {{singlerank.rank}}
                            </td>
                            <td class="pmrequest-tablenew-td-border-left">
                                {{singlerank.defaultcount}}
                            </td>
                            <td>
                                <table class="pmrequest-autowidth">
                                    <tr>
                                        <td v-for="i in absoluteup" class="pmrequest-tablenew-td-subnumber " :style="tableautowidth(absoluteup)">
                                            <template v-if="getUpinfo(singlerank, i) != null">
                                                {{getUpinfo(singlerank, i).value}}
                                            </template>
                                            <template v-else>
                                                -
                                            </template>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr class="pmrequest-tablenew-back-silver">
                            <td>
                                Переменный состав
                            </td>
                            <td class="pmrequest-tablenew-td-border-left">
                                {{countvar}}
                            </td>
                            <td>
                                <table class="pmrequest-autowidth">
                                    <tr>
                                        <td v-for="i in absoluteup" class="pmrequest-tablenew-td-subnumber " :style="tableautowidth(absoluteup)">
                                            -
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr v-for="singlerank in pmresultsingleranks" v-if="singlerank.defaultcountvar > 0" class="pmrequest-table-tr pmrequest-tablenew-back-silver">
                            <td>
                                {{singlerank.rank}}
                            </td>
                            <td class="pmrequest-tablenew-td-border-left">
                                {{singlerank.defaultcountvar}}
                            </td>
                            <td>
                                <table class="pmrequest-autowidth">
                                    <tr>
                                        <td v-for="i in absoluteup" class="pmrequest-tablenew-td-subnumber " :style="tableautowidth(absoluteup)">
                                            {{singlerank.defaultcountvar}}
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr v-for="civilPart in civil" class="pmrequest-tablenew-back-green">
                            <td>
                                {{civilPart.name}}
                            </td>
                            <td class="pmrequest-tablenew-td-border-left">
                                {{civilPart.count}}
                            </td>
                            <td>
                                <table class="pmrequest-autowidth">
                                    <tr>
                                        <td v-for="i in absoluteup" class="pmrequest-tablenew-td-subnumber " :style="tableautowidth(absoluteup)">
                                            -
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>

            <el-button @click="downloadExcel">Скачать Excel</el-button>
        </el-dialog>

    </div>
</template>
<script src="./pmrequestpanel.ts"></script>